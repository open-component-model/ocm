description: |
  This package describes the deployment of a simple echoserver
  into a namespace of a Kubernetes cluster.
executors:
  - resourceRef:
      resource:
        name: toiexecutor
      referencePath:
        - name: installer
    config: (( read("helmconfig.yaml") ))
credentials:
  target:
    description: Kubeconfig for installation

# template used for generating the values file passed to helm
# merges the values from executors/config/values
# default helm values can be provided here. Do not forget merging the client
# parameters. Otherwise no client values can be provided.
configTemplate:
  namespace: default
  release: echoserver
  replicaCount: 1
  <<: (( merge ))     # merge all user provided values with configured defaults
configScheme:
  type: object
  additionalProperties: false  # set to true to allow arbitrary values
  properties:
    release:
      type: string
    namespace:
      type: string
    replicaCount:
      type: int
    ingress:
      type: object
    resources:
      type: object
    autoscaling:
      type: object
    nodeSelector:
      type: object
    tolerations:
      type: object
    affinity:
      type: object
    serviceAccount:
      type: object
    podAnnotations:
      type: object
    podSecurityContext:
      type: object
    securityContext:
      type: object
    service:
      type: object
additionalResources:
  configFile:
    resource:
      name: config-example
  credentialsFile:
    resource:
      name: creds-example
